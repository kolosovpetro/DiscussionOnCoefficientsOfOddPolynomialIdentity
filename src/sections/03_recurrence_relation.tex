In 2018, a recurrence formula~\cite{alekseyev2018mathoverflow} for coefficients $\coeffA{m}{r}$
was proposed by Dr. Max Alekseyev, George Washington University.
The main idea of Alekseyev's approach was to utilize a generating function to evaluate
the set of coefficients $\coeffA{m}{r}$
starting from the base case $\coeffA{m}{m}$, then to evaluate previous coefficient $\coeffA{m}{m-1}$
recursively, similarly up to $\coeffA{m}{0}$.
We utilize Binomial theorem and a specific version
of Faulhaber's formula~\cite{beardon1996sums} with upper summation bound set to $p+1$
\begin{align*}
    \sum_{k=1}^{n} k^{p}
    = \frac{1}{p+1}\sum_{j=0}^{p} \binom{p+1}{j} \bernoulli{j} n^{p+1-j}
    &= \frac{1}{p+1} \left[ \sum_{j=0}^{p+1} \binom{p+1}{j} \bernoulli{j} n^{p+1-j} \right] - \frac{\bernoulli{p+1}}{p+1}
\end{align*}
The reason we use the Faulhaber's formula above is because we tend to omit summation bounds, for simplicity.
This helps us to collapse the common terms across complex sums, because now we can let the sum run over all integers $j$,
while only finitely many terms $\binom{p+1}{j}$ are non-zero, see also~\cite{knuth1992two}.
Hence,
\begin{align}
    \label{eq:modified-faulhabers-formula}
    \sum_{k=1}^{n} k^{p}
    = \frac{1}{p+1} \left[ \sum_{j} \binom{p+1}{j} \bernoulli{j} n^{p+1-j} \right] - \frac{\bernoulli{p+1}}{p+1}
\end{align}
Now we expand the sum $\sum_{k=1}^{n} k^{r} (n-k)^{r}$ using binomial theorem
\begin{align*}
    \sum_{k=1}^{n} k^{r} (n-k)^{r}
    = \sum_{k=1}^{n} k^{r} \sum_{t=0}^{r} (-1)^t \binom{r}{t} n^{r-t} k^{t}
    = \sum_{t=0}^{r} (-1)^t \binom{r}{t} n^{r-t} \sum_{k=1}^{n} k^{t+r}
\end{align*}
By applying Faulhaber's formula~\eqref{eq:modified-faulhabers-formula} to $\sum_{k=1}^{n} k^{t+r}$, we get
\begin{align*}
    \sum_{k=1}^{n} k^{r} (n-k)^{r}
    &= \sum_{t=0}^{r} (-1)^t \binom{r}{t} n^{r-t} \left[ \left( \frac{1}{t+r+1} \sum_{j} \binom{t+r+1}{j} \bernoulli{j} n^{t+r+1-j} \right) - \frac{\bernoulli{t+r+1}}{t+r+1} \right] \\
    &= \sum_{t=0}^{r} \binom{r}{t} \frac{(-1)^t}{t+r+1} \left[ \left( \sum_{j} \binom{t+r+1}{j} \bernoulli{j} n^{2r+1-j}  \right) - \bernoulli{t+r+1} n^{r-t} \right]
\end{align*}
By expanding brackets
\begin{align*}
    \sum_{k=1}^{n} k^{r} (n-k)^{r}
    = \left[ \sum_{t=0}^{r} \binom{r}{t} \frac{(-1)^t}{t+r+1} \sum_{j} \binom{t+r+1}{j} \bernoulli{j} n^{2r+1-j}  \right]
    - \left[ \sum_{t=0}^{r} \binom{r}{t} \frac{(-1)^t}{t+r+1} \bernoulli{t+r+1} n^{r-t} \right]
\end{align*}
By moving the sum in $j$ and omitting summation bounds in $t$
\begin{align*}
    \sum_{k=1}^{n} k^{r} (n-k)^{r}
    = \left[ \sum_{j, t} \binom{r}{t} \frac{(-1)^t}{t+r+1} \binom{t+r+1}{j} \bernoulli{j} n^{2r+1-j}  \right]
    - \left[ \sum_{t} \binom{r}{t} \frac{(-1)^t}{t+r+1} \bernoulli{t+r+1} n^{r-t} \right]
\end{align*}
By rearranging the sums we obtain
\begin{align}
    \label{eq:rearranging-terms}
    \sum_{k=1}^{n} k^{r} (n-k)^{r}
    &= \left[ \sum_{j} \bernoulli{j} n^{2r+1-j} \sum_{t} \binom{r}{t} \frac{(-1)^t}{t+r+1} \binom{t+r+1}{j}  \right] \\
    &- \left[ \sum_{t} \binom{r}{t} \frac{(-1)^t}{t+r+1} \bernoulli{t+r+1} n^{r-t} \right] \nonumber
\end{align}
We can notice that
\input{sections/equations/01_altering_binomial_identity_lemma}
To simplify equation~\eqref{eq:rearranging-terms} using binomial identity~\eqref{lem:piecewise-binomial-identity}, we have to move $j=0$ out of
summation, to avoid division by zero in $\frac{(-1)^r}{j}$.
Therefore,
\begin{equation*}
    \begin{split}
        \sum_{k=1}^{n} k^{r} (n-k)^{r}
        &= \frac{1}{(2r+1) \binom{2r}r} n^{2r+1}
        + \left[ \sum_{j = 1}^{\infty} \bernoulli{j} n^{2r+1-j} \sum_{t} \binom{r}{t} \frac{(-1)^t}{t+r+1} \binom{t+r+1}{j} \right] \\
        &- \left[ \sum_{t} \binom{r}{t} \frac{(-1)^t}{t+r+1} \bernoulli{t+r+1} n^{r-t} \right]
    \end{split}
\end{equation*}
Hence, we simplify equation~\eqref{eq:rearranging-terms} by using binomial identity~\eqref{lem:piecewise-binomial-identity}
\begin{equation*}
    \begin{split}
        \sum_{k=1}^{n} k^{r} (n-k)^{r}
        &= \frac{1}{(2r+1) \binom{2r}r} n^{2r+1}
        + \left[ \sum_{j=1}^{\infty} \frac{(-1)^r}{j} \binom{r}{2r-j+1} \bernoulli{j} n^{2r-j+1} \right] \\
        &- \left[ \sum_{t} \binom{r}{t} \frac{(-1)^t}{t+r+1} \bernoulli{t+r+1} n^{r-t} \right]
    \end{split}
\end{equation*}
By setting $\ell=2r-j+1$ to $\sum_{j=1}^{\infty}$, and $\ell=r-t$ to $\sum_{t}$,
we collapse common terms across two sums
\begin{align*}
    \sum_{k=1}^{n} k^{r} (n-k)^{r}
    &= \frac{1}{(2r+1) \binom{2r}r} n^{2r+1}
    + \left[ \sum_{\ell} \frac{(-1)^r}{2r+1-\ell} \binom{r}{\ell} \bernoulli{2r+1-\ell} n^{\ell} \right] \\
    &- \left[ \sum_{\ell} \binom{r}{\ell} \frac{(-1)^{r-\ell}}{2r+1-\ell} \bernoulli{2r+1-\ell} n^{\ell} \right]\\
    &= \frac{1}{(2r+1) \binom{2r}r} n^{2r+1} + 2 \sum_{\mathrm{odd \; \ell}} \frac{(-1)^r}{2r+1-\ell} \binom{r}{\ell} \bernoulli{2r+1-\ell} n^{\ell}
\end{align*}
By replacing odd $\ell = 2k+1$, we get
\begin{proposition}[Bivariate Faulhaber's Formula]
    \label{prop:bivariate-faulhabers-formula}
    \begin{align*}
        \sum_{k=1}^{n} k^{r} (n-k)^{r}
        = \frac{1}{(2r+1) \binom{2r}r} n^{2r+1}
        + \sum_{k=0}^{\infty} \frac{(-1)^r}{r-k} \binom{r}{2k+1} \bernoulli{2r-2k} n^{2k+1}
    \end{align*}
\end{proposition}
Assuming that coefficients $\coeffA{m}{r}$ are defined
by odd-power identity~\eqref{eq:odd-power-identity},
we obtain the following relation for polynomials in $n$
\begin{align}
    \label{eq:generating-function}
    R_{m} = \sum_{r=0}^{m} \coeffA{m}{r} \frac{1}{(2r+1) \binom{2r}{r}} n^{2r+1}
    + \sum_{r=0}^{m} \sum_{k=0}^{\infty} \coeffA{m}{r} \frac{(-1)^r}{r-k} \binom{r}{2k+1} \bernoulli{2r-2k} n^{2k+1}
    - n^{2m+1} \equiv 0
\end{align}
We now fix the unused values of $\coeffA{m}{r}$ so that $\coeffA{m}{r} = 0$ for every $r < 0$ or $r > m$.
By extracting the coefficient of $n^{2m+1}$ in~\eqref{eq:generating-function} implies
\begin{align*}
    \coeffA{m}{m} = (2m+1)\binom{2m}{m}
\end{align*}
because $[n^{2m+1}]R_m = \coeffA{m}{m} \frac{1}{(2m+1) \binom{2m}{m}} - 1 = 0$.
To extract the coefficient of $n^{2m+1}$ from the series~\eqref{eq:generating-function},
we isolate the relevant terms by setting $r = m$,
and $k = m$, which gives
\begin{align*}
[n^{2m+1}]
    R_{m}
    = \coeffA{m}{m} \frac{1}{(2m+1) \binom{2m}{m}}
    + \sum_{r=0}^{m} \coeffA{m}{r} \frac{(-1)^r}{r - m} \binom{r}{2m+1} \bernoulli{2r - 2m}
    - 1 = 0
\end{align*}
We observe that the sum
\begin{align*}
    \sum_{r=0}^{m} \coeffA{m}{r} \frac{(-1)^r}{r - m} \binom{r}{2m+1} \bernoulli{2r - 2m}
\end{align*}
does not contribute to the determination of the coefficients $\coeffA{m}{r}$, because the binomial coefficient
$\binom{r}{2m+1}$ vanishes for all $r \leq m$.
Consequently, all terms in the sum are zero.
Thus,
\begin{align*}
    \coeffA{m}{m} \frac{1}{(2m+1) \binom{2m}{m}}  - 1 = 0 \implies \coeffA{m}{m} = (2m+1) \binom{2m}{m}
\end{align*}
Taking the coefficient of $n^{2d+1}$ for an integer $d$ in range $\frac{m}{2} \leq d \leq m-1$ in~\eqref{eq:generating-function} gives
\begin{align*}
[n^{2d+1}]
    R_m = \coeffA{m}{d} \frac{1}{(2d+1) \binom{2d}{d}} + \sum_{r=0}^m \coeffA{m}{r} \frac{(-1)^r}{r-d} \binom{r}{2d+1} \bernoulli{2r-2d} = 0
\end{align*}
For every $\frac{m}{2} \leq d$, the binomial coefficient $\binom{r}{2d+1}$ vanishes, because for all $r \leq m$
holds $r < 2d+1$.
As a particular example, when $r = m$ and $d = \frac{m}{2}$, we have
\begin{align*}
    \binom{m}{m+1} = 0.
\end{align*}
Therefore, the entire sum involving $\binom{r}{2d+1}$ vanishes, and we conclude
that for all integers $d$ such that $\frac{m}{2} \leq d \leq m-1$ the coefficients $\coeffA{m}{d}$
are zeroes
\begin{align*}
    \coeffA{m}{d} \frac{1}{(2d+1) \binom{2d}{d}} = 0 \implies \coeffA{m}{d} = 0.
\end{align*}
In contrast, for values $d \leq \frac{m}{2} - 1$, the binomial coefficient $\binom{r}{2d+1}$ can be nonzero; for instance, if $r = m$ and $d = \frac{m}{2} - 1$, then
\begin{align*}
    \binom{m}{m - 1} \neq 0,
\end{align*}
allowing the corresponding terms to contribute to the determination of $\coeffA{m}{d}$.
Taking the coefficient of $n^{2d+1}$ for $d$ in range $\frac{m}{4} \leq d < \frac{m}{2}$ in~\eqref{eq:generating-function}, we obtain
\begin{align*}
    \coeffA{m}{d} \frac{1}{(2d+1) \binom{2d}{d}}
    + 2 (2m+1) \binom{2m}{m} \binom{m}{2d+1} \frac{(-1)^m}{2m - 2d} \bernoulli{2m - 2d} = 0.
\end{align*}
Solving for $\coeffA{m}{d}$ yields
\begin{equation*}
    \coeffA{m}{d}
    = (-1)^{m-1} \frac{(2m+1)!}{d! \, d! \, m! \, (m - 2d - 1)!} \cdot \frac{1}{m - d} \bernoulli{2m - 2d}.
\end{equation*}
Proceeding recursively, we can compute each coefficient $\coeffA{m}{r}$ for integers $r$ in range
$\frac{m}{2^{s+1}} \leq r < \frac{m}{2^s}$ for $s = 1, 2, \ldots$,
by using previously computed values $\coeffA{m}{d}$
\begin{equation*}
    \coeffA{m}{r} =
    (2r+1) \binom{2r}{r} \sum_{d = 2r+1}^{m}
    \coeffA{m}{d} \binom{d}{2r+1} \frac{(-1)^{d-1}}{d - r} \bernoulli{2d - 2r}.
\end{equation*}
Finally, we define the following recurrence relation for coefficients $\coeffA{m}{r}$
\begin{proposition}
    For integers $m$ and $r$
    \label{prop:coefficients_a}
    \begin{align*}
        \coeffA{m}{r} =
        \begin{cases}
        (2r+1)
            \binom{2r}{r} & \mathrm{if} \; r=m \\
            (2r+1) \binom{2r}{r} \sum_{d = 2r+1}^{m} \coeffA{m}{d} \binom{d}{2r+1} \frac{(-1)^{d-1}}{d-r}
            \bernoulli{2d-2r} & \mathrm{if} \; 0 \leq r<m \\
            0 & \mathrm{if} \; r<0 \; \mathrm{or} \; r>m
        \end{cases}
    \end{align*}
    where $\bernoulli{t}$ are Bernoulli numbers~\cite{weisstein2002bernoulli}.
    We assume that $\bernoulli{1}=\frac{1}{2}$.
\end{proposition}
For example,
\input{sections/figures/05_fig_coefficients_a}
Properties of the coefficients $\coeffA{m}{r}$
\begin{itemize}
    \item $\coeffA{m}{m} = (2m+1)\binom{2m}{m}$.
    \item $\coeffA{m}{r} = 0$ for $r < 0$ and $r > m$.
    \item $\coeffA{m}{r} = 0$ for $m < 0$.
    \item $\coeffA{m}{r} = 0$ for $\lfloor \frac{m}{2} \rfloor \leq r < m$.
    \item $\coeffA{m}{0} = 1$ for $m \geq 0$.
    \item $\coeffA{m}{r}$ are all integers up to row $m = 11$.
    \item Row sums: $\sum_{r=0}^{m} \coeffA{m}{r} = 2^{2m+1} - 1$.
\end{itemize}
\begin{proposition}[Odd power identity]
    \label{prop:odd-power-identity}
    For non-negative integers $n$ and $m$,
    there is a set of coefficients $\coeffA{m}{0}, \coeffA{m}{1}, \ldots, \coeffA{m}{m}$ such that
    \begin{align*}
        n^{2m+1} = \sum_{r=0}^{m} \sum_{k=1}^{n} \coeffA{m}{r} k^r (n-k)^r
    \end{align*}
\end{proposition}
For example,
\begin{itemize}
    \item $1^{2m+1} = \sum_{r=0}^{m} \coeffA{m}{r} \left[ 0^r  \right]$
    \item $2^{2m+1} = \sum_{r=0}^{m} \coeffA{m}{r} \left[ 1^r + 0^r  \right]$
    \item $3^{2m+1} = \sum_{r=0}^{m} \coeffA{m}{r} \left[ 2^r + 2^r + 0^r  \right]$
    \item $4^{2m+1} = \sum_{r=0}^{m} \coeffA{m}{r} \left[ 3^r + 4^r + 3^r + 0^r  \right]$
    \item $5^{2m+1} = \sum_{r=0}^{m} \coeffA{m}{r} \left[ 4^r + 6^r + 6^r + 4^r + 0^r  \right]$
    \item $6^{2m+1} = \sum_{r=0}^{m} \coeffA{m}{r} \left[ 5^r + 8^r + 9^r + 8^r + 5^r + 0^r  \right]$
\end{itemize}
We define $x^0 = 1$ for all $x$, see~\cite[~p. 162]{graham1994concrete}.
This is because when $k=n$ and $r=0$ the term $k^r (n-k)^r = n^0 \cdot 0^0$, thus we define $x^0 = 1$
for all $x$.
